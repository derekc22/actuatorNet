Old OOP version. Have not yet committed functional version.
